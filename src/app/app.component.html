<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">

<label for="statuses">Status:</label>
<select id="statuses" (change)="onChangeStatus($event)">
  <option value="All">All</option>
  <option value="Active">Active</option>
  <option value="Finished">Finished</option>
  <option value="Postpone">Postponed</option>
</select>

<a href="#" (click)="openModal(null, 'add')">add task</a><br/>

<div class="container" id="container">
    <div *ngFor="let task of tasks">
        <div class="row">
            <div class="col-md-5">
                <div class="widget widget-reminder">
                    <div class="widget-reminder-header">{{task.endDate}}</div>
                    <div class="widget-reminder-container">
                        <div class="widget-reminder-time">
                            <a href="#" (click)="openModal(task, 'update')">update</a><br/>
                            <a href="#" (click)="openModal(task, 'delete')" style="color: red;">delete</a><br/>
                        </div>
                        <div class="widget-reminder-divider bg-primary"></div>
                        <div class="widget-reminder-content">
                            <h4 class="widget-title">{{task.task}}</h4>
                            <div class="widget-desc">{{task.status.status}}</div>
                            <div class="m-t-15">
                                <a href="#" (click)="onDownloadFile(task)">{{task.file?.name}}</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Pagination -->
<div class="pagination">
    <a href="#" (click)="changePage(pagination.page - 1)">&laquo;</a>
    <div *ngFor="let item of [].constructor(pagination.totalPages); let i = index">
        <a href="#" [ngClass]="{'active' : i + 1 == pagination.page}" (click)="changePage(i + 1)">{{i + 1}}</a>
     </div>
    <a href="#" (click)="changePage(pagination.page + 1)">&raquo;</a>
</div>

<!-- Add Task Modal -->
<div class="modal fade" id="addTaskModal" tabindex="-1" role="dialog" aria-labelledby="addTaskModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <form #addForm="ngForm" (ngSubmit)="onAddTask(addForm)">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="addTaskModalLabel">Add Task</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label for="add-task">Task</label>
                        <input type="text" name="task" ngModel class="form-control" id="add-task" placeholder="Task" required>
                    </div>
                    <div class="form-group">
                        <label for="add-end_date">End date</label>
                        <input type="text" name="end_date" ngModel class="form-control" id="add-end_date" placeholder="end date" required>
                    </div>
                    <div class="form-group">
                        <label for="file">File</label>
                        <input type='file' name="file" id="file" (change)="loadFile($event)">
                    </div>
                    <div class="modal-footer">
                        <button type="button" id="close-add-task" class="btn btn-secondary" data-dismiss="modal">Close</button>
                        <button type="submit" class="btn btn-primary">Add</button>
                    </div>
                </div>
            </div>
        </form>
    </div>
</div>

<!-- Update Task Modal -->
<div class="modal fade" id="updateTaskModal" tabindex="-1" role="dialog" aria-labelledby="updateTaskModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <form #updateForm="ngForm" (ngSubmit)="onUpdateTask(updateForm)">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="updateTaskModalLabel">Update Task</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label for="task">Task</label>
                        <input type="text" name="task" ngModel class="form-control" id="task" value="{{task?.task}}" required>
                    </div>
                    <div class="form-group">
                        <label for="end_date">End date</label>
                        <input type="text" name="end_date" ngModel class="form-control" id="end_date" value="{{task?.endDate}}" required>
                    </div>
                    <div *ngIf="hasFile">
                      <a href="#" (click)="onDeleteFile()" style="color: red;">deleteFile</a><br/>
                    </div>
                    <div *ngIf="!hasFile">
                      <div class="form-group">
                        <label for="file">File</label>
                        <input type='file' ngModel name="file" (change)="loadFile($event)">
                      </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" id="close-update-task" class="btn btn-secondary" data-dismiss="modal">Close</button>
                        <button type="submit" class="btn btn-primary">Save changes</button>
                    </div>
                </div>
            </div>
        </form>
    </div>
</div>

<!-- Delete Modal -->
<div class="modal fade" id="deleteTaskModal" tabindex="-1" role="dialog" aria-labelledby="deleteModelLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
       <div class="modal-content">
          <div class="modal-header">
             <h5 class="modal-title" id="deleteModelLabel">Delete Task</h5>
             <button type="button" class="close" data-dismiss="modal" aria-label="Close">
             <span aria-hidden="true">&times;</span>
             </button>
          </div>
          <div class="modal-body">
             <p>Are you sure you want to delete task {{task?.task}}?</p>
             <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">No</button>
                <button (click)="onDeleteTask(task.id)" class="btn btn-danger" data-dismiss="modal">Yes</button>
             </div>
          </div>
       </div>
    </div>
</div>

<!-- Authenticate Modal -->
<div class="modal fade" id="authenticateModal" tabindex="-1" data-backdrop="static" data-keyboard="false" role="dialog" aria-labelledby="authenticateModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <form #authenticateForm="ngForm" (ngSubmit)="authenticate(authenticateForm)">
            <div class="modal-content">
                <div class="modal-body">
                    <div class="form-group">
                        <label for="login">Login</label>
                        <input type="text" name="login" ngModel class="form-control" id="login" placeholder="login" required>
                    </div>
                    <div class="form-group">
                        <label for="password">Password</label>
                        <input type="text" name="password" ngModel class="form-control" id="password" placeholder="password" required>
                    </div>
                    <div class="modal-footer">
                        <input type="hidden" id="close-authentication-modal" class="btn btn-secondary" data-dismiss="modal">
                        <button type="submit" class="btn btn-primary">login</button>
                    </div>
                </div>
            </div>
        </form>
    </div>
</div>
